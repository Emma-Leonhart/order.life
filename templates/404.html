<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>404 — Page Not Found — 命</title>
  <link rel="icon" href="/static/favicon.svg" type="image/svg+xml">
  <link rel="stylesheet" href="/static/css/style.css">
  <script>
  // ── Client-side routing for paths without a pre-generated file ────────────
  (function () {
    var p = window.location.pathname;

    // 1. Wiki redirect — runs immediately (no DOM needed)
    var mWiki = p.match(/^\/([a-z]{2})\/wiki\/(.+?)\/?\s*$/) || p.match(/^\/wiki\/(.+?)\/?\s*$/);
    if (mWiki) {
      var lang, title;
      if (mWiki.length === 3) { lang = mWiki[1]; title = mWiki[2]; }
      else                    { lang = 'en';      title = mWiki[1]; }
      title = title.replace(/\/$/, '') || 'Main_Page';
      window.location.replace('https://wiki.order.life/' + title);
      return;
    }

    // 2. Year / festivals pages — set globals now, do DOM work after load
    // English pages have no /en/ prefix; other languages do.
    var mYear = p.match(/^\/([a-z]{2})\/calendar\/year\/(\d+)\/(festivals\/)?$/)
             || p.match(/^\/calendar\/year\/(\d+)\/(festivals\/)?$/);
    if (mYear) {
      var lang   = mYear.length === 4 ? mYear[1] : 'en';
      var year   = parseInt(mYear.length === 4 ? mYear[2] : mYear[1], 10);
      var isFest = !!(mYear.length === 4 ? mYear[3] : mYear[2]);

      if (!year || year < 1 || year > 999999) return;

      // Expose globals that the year scripts read
      window.LANG_BASE           = '/' + lang;
      window.GAIAN_YEAR          = year;
      window.GAIAN_MONTH_NAMES   = ['Sagittarius','Capricorn','Aquarius','Pisces','Aries',
                                     'Taurus','Gemini','Cancer','Leo','Virgo','Libra',
                                     'Scorpius','Ophiuchus','Horus'];
      window.GAIAN_WEEKDAY_NAMES = ['Monday','Tuesday','Wednesday','Thursday',
                                     'Friday','Saturday','Sunday'];

      // Load CSS immediately (head is available)
      var link = document.createElement('link');
      link.rel  = 'stylesheet';
      link.href = isFest ? '/static/css/year-festivals.css' : '/static/css/year-page.css';
      document.head.appendChild(link);

      // Update page title immediately
      document.title = year + ' GE' + (isFest ? ' \u2014 Festivals' : '') + ' \u2014 \u547D';

      // All DOM manipulation must wait until the body is parsed
      document.addEventListener('DOMContentLoaded', function () {
        var b = '/' + lang;

        // Replace nav
        document.getElementById('_404_nav').innerHTML =
          '<a class="nav-brand" href="' + b + '/"><span class="brand-kanji">\u547D</span> Order of Life</a>' +
          '<div class="nav-links">' +
            '<a href="' + b + '/calendar/">Calendar</a>' +
            '<a href="' + b + '/gaiad/">Gaiad</a>' +
            '<a href="' + b + '/mythology/">Mythology</a>' +
            '<a href="' + b + '/philosophy/">Philosophy</a>' +
            '<a href="' + b + '/shrines/">Shrines</a>' +
            '<a href="' + b + '/longevity/">Longevity</a>' +
            '<a href="' + b + '/evolution/">Evolution</a>' +
          '</div>';

        // Build page content
        var yearPath = b + '/calendar/year/' + year + '/';
        var breadcrumb = isFest
          ? '<a href="' + b + '/">Home</a><span>\u203a</span><a href="' + b + '/calendar/">Calendar</a><span>\u203a</span><a href="' + yearPath + '">' + year + '</a><span>\u203a</span>Festivals'
          : '<a href="' + b + '/">Home</a><span>\u203a</span><a href="' + b + '/calendar/">Calendar</a><span>\u203a</span>' + year;

        var festLegend = isFest ? (
          '<div class="fest-legend">' +
            '<div class="fest-legend-item"><span class="leg-dot" style="background:#aaa"></span> Full moon</div>' +
            '<div class="fest-legend-item"><span class="leg-bar" style="background:#cc3333"></span> Chinese New Year \u2192 Lantern Festival</div>' +
            '<div class="fest-legend-item"><span class="leg-bar" style="background:#3a6dbf"></span> Purim \u2192 Sukkot (Jewish sequence)</div>' +
            '<div class="fest-legend-item"><span class="leg-bar" style="background:#88aaee"></span> Hanukkah</div>' +
            '<div class="fest-legend-item"><span class="leg-bar" style="background:#cc6600"></span> Ash Wednesday \u2192 Pentecost (Christian)</div>' +
            '<div class="fest-legend-item"><span class="leg-bar" style="background:#228855"></span> Ramadan \u2192 Eid al-Fitr \u00b7 Eid al-Adha</div>' +
            '<div class="fest-legend-item"><span class="leg-dot" style="background:#9933bb"></span> Diwali</div>' +
          '</div>' +
          '<p class="fest-note">Islamic dates are calculated and may differ by \u00b11\u20132\u00a0days from announced dates ' +
          'depending on regional moon sighting. Jewish dates from 2027 onward are estimated via the 19-year Metonic cycle.</p>'
        ) : '';

        document.getElementById('_404_body').innerHTML =
          '<div class="section-hero">' +
            '<h1 id="year-heading">' + year + ' GE' + (isFest ? ' \u2014 Festivals' : '') + '</h1>' +
            '<p id="year-subheading" style="color:var(--text-muted);font-size:0.9rem">Loading\u2026</p>' +
          '</div>' +
          '<div class="container">' +
            '<div class="breadcrumb">' + breadcrumb + '</div>' +
            '<div id="year-intro" class="year-intro"><p style="color:var(--text-muted)">Loading\u2026</p></div>' +
            '<div id="year-calendar"></div>' +
            festLegend +
          '</div>';

        // Load the rendering script now that the DOM structure is in place
        var script = document.createElement('script');
        script.src = isFest ? '/static/js/year-festivals.js' : '/static/js/year-page.js';
        document.body.appendChild(script);
      });
    }
  })();
  </script>
</head>
<body>
  <nav>
    <div class="nav-inner" id="_404_nav">
      <a class="nav-brand" href="/"><span class="brand-kanji">命</span> Order of Life</a>
      <div class="nav-links">
        <a href="/calendar/">Calendar</a>
        <a href="/gaiad/">Gaiad</a>
        <a href="/mythology/">Mythology</a>
        <a href="/philosophy/">Philosophy</a>
        <a href="/shrines/">Shrines</a>
      </div>
    </div>
  </nav>

  <div id="_404_body">
    <div class="section-hero">
      <h1>404</h1>
      <p>This page does not exist in any realm.</p>
    </div>

    <div class="container" style="text-align: center; padding: 3rem 1rem;">
      <p style="font-size: 1.1rem; margin-bottom: 2rem;">The path you sought leads nowhere — yet. Perhaps it will be hallowed in time.</p>
      <a href="/" style="color: #ffd700; text-decoration: none; font-size: 1.1rem;">Return to the homepage</a>
    </div>
  </div>

  <footer>
    <p>命道教 · Lifeism · Order of Life</p>
  </footer>
</body>
</html>
